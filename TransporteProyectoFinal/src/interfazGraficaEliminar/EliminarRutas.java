/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * EliminarUnidades.java
 *
 * Created on 09/07/2011, 11:24:21 PM
 */

package interfazGraficaEliminar;

import excepciones.FachadaException;
import fachadas.ListadoAsientos;
import fachadas.ListadoBoletos;
import fachadas.ListadoRutas;
import fachadas.ListadoUnidades;
import interfazGrafica.Menu;
import java.util.Vector;
import javax.swing.JOptionPane;
import objetoProyecto.Asiento;
import objetoProyecto.Boleto;
import objetoProyecto.Ruta;
import objetoProyecto.Unidad;

/**
 *
 * @author Gustavo
 */
public class EliminarRutas extends javax.swing.JFrame {

    /** Creates new form EliminarUnidades */
    public EliminarRutas() {
        initComponents();
        setLocationRelativeTo(null);
    }
private Ruta buscado=new Ruta();
private Unidad unidBuscada =new Unidad();
private ListadoRutas listaRutas=new ListadoRutas();
private ListadoUnidades listaUnidades=new ListadoUnidades();
private ListadoBoletos listaBoletos=new ListadoBoletos();
private ListadoAsientos listaAsientos=new ListadoAsientos();
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        cancelar = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        codigo = new javax.swing.JTextField();
        jLabel11 = new javax.swing.JLabel();
        jLabel13 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        buscar = new javax.swing.JButton();
        eliminar = new javax.swing.JButton();
        año = new javax.swing.JLabel();
        salidaActual = new javax.swing.JLabel();
        llegadaActual = new javax.swing.JLabel();
        tiempoAproximado = new javax.swing.JLabel();
        costo = new javax.swing.JLabel();
        horaViaje = new javax.swing.JLabel();
        distancia = new javax.swing.JLabel();
        unidadActual = new javax.swing.JLabel();
        mes = new javax.swing.JLabel();
        dia = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
        setTitle("Cooperativa");
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        cancelar.setText("CANCELAR");
        cancelar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cancelarActionPerformed(evt);
            }
        });
        getContentPane().add(cancelar, new org.netbeans.lib.awtextra.AbsoluteConstraints(366, 379, -1, -1));

        jLabel1.setText("ELIMINAR RUTAS");
        getContentPane().add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(174, 11, -1, -1));

        jLabel2.setText("Código ruta:");
        getContentPane().add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(23, 65, -1, -1));

        jLabel3.setText("Lugar salida:");
        getContentPane().add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(23, 100, -1, -1));

        jLabel4.setText("Lugar llegada:");
        getContentPane().add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(23, 136, -1, -1));

        jLabel5.setText("Tiempo aproximado:");
        getContentPane().add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(23, 179, -1, -1));

        jLabel6.setText("Costo ruta:");
        getContentPane().add(jLabel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(23, 209, -1, -1));

        jLabel7.setText("Hora:");
        getContentPane().add(jLabel7, new org.netbeans.lib.awtextra.AbsoluteConstraints(23, 239, -1, -1));

        jLabel8.setText("Distancia:");
        getContentPane().add(jLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(23, 279, -1, -1));

        jLabel9.setText("Unidad:");
        getContentPane().add(jLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(23, 309, -1, -1));

        jLabel10.setText("Fecha:");
        getContentPane().add(jLabel10, new org.netbeans.lib.awtextra.AbsoluteConstraints(23, 339, 97, -1));
        getContentPane().add(codigo, new org.netbeans.lib.awtextra.AbsoluteConstraints(215, 72, 79, -1));

        jLabel11.setText("dd/mm/aaaa");
        getContentPane().add(jLabel11, new org.netbeans.lib.awtextra.AbsoluteConstraints(405, 337, 80, -1));

        jLabel13.setText("hh.mm");
        getContentPane().add(jLabel13, new org.netbeans.lib.awtextra.AbsoluteConstraints(297, 240, 40, -1));

        jLabel14.setText("/");
        getContentPane().add(jLabel14, new org.netbeans.lib.awtextra.AbsoluteConstraints(315, 337, 10, -1));

        jLabel15.setText("KM");
        getContentPane().add(jLabel15, new org.netbeans.lib.awtextra.AbsoluteConstraints(323, 269, 30, -1));

        jLabel16.setText("/");
        getContentPane().add(jLabel16, new org.netbeans.lib.awtextra.AbsoluteConstraints(255, 337, 10, -1));

        buscar.setText("BUSCAR");
        buscar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buscarActionPerformed(evt);
            }
        });
        getContentPane().add(buscar, new org.netbeans.lib.awtextra.AbsoluteConstraints(330, 70, -1, -1));

        eliminar.setText("ELIMINAR");
        eliminar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                eliminarActionPerformed(evt);
            }
        });
        getContentPane().add(eliminar, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 379, -1, -1));

        año.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        getContentPane().add(año, new org.netbeans.lib.awtextra.AbsoluteConstraints(330, 340, 40, 19));

        salidaActual.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        getContentPane().add(salidaActual, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 110, 230, 19));

        llegadaActual.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        getContentPane().add(llegadaActual, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 140, 230, 19));

        tiempoAproximado.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        getContentPane().add(tiempoAproximado, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 170, 100, 19));

        costo.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        getContentPane().add(costo, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 200, 100, 19));

        horaViaje.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        getContentPane().add(horaViaje, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 240, 80, 19));

        distancia.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        getContentPane().add(distancia, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 270, 100, 19));

        unidadActual.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        getContentPane().add(unidadActual, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 300, 50, 19));

        mes.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        getContentPane().add(mes, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 340, 40, 19));

        dia.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        getContentPane().add(dia, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 340, 40, 19));

        jLabel17.setText("horas");
        getContentPane().add(jLabel17, new org.netbeans.lib.awtextra.AbsoluteConstraints(320, 170, 30, 20));

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void cancelarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cancelarActionPerformed
        // TODO add your handling code here:
        Menu me=new Menu();
        dispose();
        me.setVisible(true);
}//GEN-LAST:event_cancelarActionPerformed

    private void buscarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buscarActionPerformed
        // TODO add your handling code here:
        unidadActual.setText("");
        llegadaActual.setText("");
        salidaActual.setText("");
        tiempoAproximado.setText("");
        costo.setText("");
        horaViaje.setText("");
        distancia.setText("");
        dia.setText("");
        mes.setText("");
        año.setText("");
        buscado=null;
        if(!codigo.getText().equals("")){
            Ruta ruta=new Ruta();
            ruta.setCodigoRuta(codigo.getText());
            try{
                buscado=listaRutas.obten(ruta);
            }catch(FachadaException fe){
                JOptionPane.showMessageDialog(null,"Error: " + fe.getMessage());
            }
            if(buscado!=null){
                salidaActual.setText(buscado.getLugarSalida());
                llegadaActual.setText(buscado.getLugarLlegada());
                unidadActual.setText(buscado.getUnidad());
                tiempoAproximado.setText(String.valueOf(buscado.getTiempoAproximado()));
                costo.setText(String.valueOf(buscado.getCostoRuta()));
                horaViaje.setText(String.valueOf(buscado.getHora()));
                dia.setText(String.valueOf(buscado.getFecha().getDia()));
                mes.setText(String.valueOf(buscado.getFecha().getMes()));
                año.setText(String.valueOf(buscado.getFecha().getAño()));
                distancia.setText(String.valueOf(buscado.getDistancia()));
            }
 else{
                JOptionPane.showMessageDialog(null, "La ruta no existe");
                unidadActual.setText("");
        llegadaActual.setText("");
        salidaActual.setText("");
        tiempoAproximado.setText("");
        costo.setText("");
        horaViaje.setText("");
        distancia.setText("");
        dia.setText("");
        mes.setText("");
        año.setText("");
 }
        }
 else{
            JOptionPane.showMessageDialog(null,"Ingrese el código de la unidad");
 }
}//GEN-LAST:event_buscarActionPerformed

    private void eliminarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_eliminarActionPerformed
        // TODO add your handling code here:
        if(buscado!=null){
            String ruta=salidaActual.getText()+"-"+llegadaActual.getText();
                Vector lista=new Vector();
                try{
                    lista=listaBoletos.consultaBoletoRuta(ruta);
                }catch(FachadaException fe){
                    JOptionPane.showMessageDialog(null,"Error: " + fe.getMessage());
                }
                for(int i=0;i<lista.size();i++){
                    try{
                        Boleto b=(Boleto)lista.get(i);
                        listaBoletos.elimina(b);
                    }catch(FachadaException fe){
                        JOptionPane.showMessageDialog(null,"Error: " + fe.getMessage());
                    }
                }

                Vector lista2=new Vector();
        try{
        lista2=listaAsientos.consultaAsientoUnidad(unidadActual.getText());
            }catch(FachadaException fe){
                JOptionPane.showMessageDialog(null,"Error: " + fe.getMessage());
            }
        for(int i=0;i<lista2.size();i++){
            try{
                Asiento a=(Asiento)lista2.get(i);
                listaAsientos.elimina(a);
            }catch(FachadaException fe){
                JOptionPane.showMessageDialog(null,"Error: " + fe.getMessage());
            }
        }

            try {
                listaRutas.elimina(buscado);
                JOptionPane.showMessageDialog(null,"Ruta eliminada con éxito");
                Unidad unidad=new Unidad();
            unidad.setCodigoUnidad(unidadActual.getText());
            try{
                unidBuscada=listaUnidades.obten(unidad);
            }catch(FachadaException fe){
                JOptionPane.showMessageDialog(null,"Error: " + fe.getMessage());
            }
            unidBuscada.setDisponibles(unidBuscada.getCapacidadUnidad());
            try {
                listaUnidades.actualiza(unidBuscada);
            } catch (FachadaException fe) {
                JOptionPane.showMessageDialog(null,"Error: " + fe.getMessage());
            }
                Menu me=new Menu();
        dispose();
        me.setVisible(true);
            } catch (FachadaException fe) {
                JOptionPane.showMessageDialog(null,"Error: " + fe.getMessage());
            }
        }
        else{
            JOptionPane.showMessageDialog(null,"Error: No se encotró la ruta");
         }
    }//GEN-LAST:event_eliminarActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel año;
    private javax.swing.JButton buscar;
    private javax.swing.JButton cancelar;
    private javax.swing.JTextField codigo;
    private javax.swing.JLabel costo;
    private javax.swing.JLabel dia;
    private javax.swing.JLabel distancia;
    private javax.swing.JButton eliminar;
    private javax.swing.JLabel horaViaje;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JLabel llegadaActual;
    private javax.swing.JLabel mes;
    private javax.swing.JLabel salidaActual;
    private javax.swing.JLabel tiempoAproximado;
    private javax.swing.JLabel unidadActual;
    // End of variables declaration//GEN-END:variables

}
